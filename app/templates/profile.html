{# app/templates/home.html #}
{% extends "home_base.html" %} {# 继承你的基础布局 #}

{% block title %}My Dashboard{% endblock %}

{% block content %}
    <h1>Welcome back, {{ current_user.firstName }}!</h1>
    <p>Here's your dashboard content...</p>
    <hr>

    <div class="add-meal-form-container"> 
        <h2><i class="fa-solid fa-plus"></i> Add New Meal</h2>
        <form action="{{ url_for('main.profile') }}" method="POST" novalidate>
            {{ form.hidden_tag() }} {# CSRF Token #}

            <div class="mb-3">
                {{ form.mealType.label(class="form-label") }}
                {{ form.mealType(class="form-select") }}
                {% for error in form.mealType.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                {% endfor %}
            </div>

            <div class="mb-3">
                {{ form.food.label(class="form-label") }}
                {{ form.food(class="form-control", placeholder="Search or enter food name") }}
                 {# TODO: Add search/autocomplete functionality later if needed #}
                {% for error in form.food.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                {% endfor %}
            </div>

            <div class="row mb-3">
                <div class="col">
                    {{ form.quantity.label(class="form-label") }}
                    {{ form.quantity(class="form-control", type="number", step="any") }} {# Use type="number" for better input #}
                    {% for error in form.quantity.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div class="col">
                    {{ form.unit.label(class="form-label") }}
                    {{ form.unit(class="form-control", placeholder="e.g., g, oz, serving") }} {# Maybe make this a dropdown later? #}
                     {% for error in form.unit.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
            </div>

            {{ form.submit(class="btn btn-primary") }} {# Assuming AddMealForm has a SubmitField named 'submit' #}
            {# <button type="submit" class="btn btn-primary">Add Meal</button> #}
        </form>
    </div>
    <hr>

    {# recent logs#}
    {% if recent_logs %}
    <h2>Recent Meals</h2>
    <ul>
        {% for log in recent_logs %}
        <li>
            {{ log.log_timestamp.strftime('%Y-%m-%d %H:%M') }} -
            {{ log.quantity_consumed }} {{ log.unit_consumed }} of
            {{ log.food_details.name }} ({{ log.meal_type }})
        </li>
        {% endfor %}
    </ul>
    {% endif %}

{% endblock %}